{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/dvoge/NJIT-Projects/PP3/scrollshopper/sns/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/dvoge/NJIT-Projects/PP3/scrollshopper/sns/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/dvoge/NJIT-Projects/PP3/scrollshopper/sns/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/Users/dvoge/NJIT-Projects/PP3/scrollshopper/sns/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import axios from\"axios\";import{useContext,useEffect,useReducer}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import Col from\"react-bootstrap/esm/Col\";import Row from\"react-bootstrap/esm/Row\";import ListGroup from\"react-bootstrap/esm/ListGroup\";import Badge from\"react-bootstrap/esm/Badge\";import Rating from\"../components/Rating\";import Button from\"react-bootstrap/esm/Button\";import{Helmet}from\"react-helmet-async\";import Card from'react-bootstrap/Card';import{Store}from\"../Store\";import LoadingBox from\"../components/LoadingBox\";import MessageBox from\"../components/MessageBox\";import{getError}from\"../utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'FETCH_REQUEST':return _objectSpread(_objectSpread({},state),{},{loading:true});case'FETCH_SUCCESS':return _objectSpread(_objectSpread({},state),{},{product:action.payload,loading:false});case'FETCH_FAIL':return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});default:return state;}};function ProductScreen(){var navigate=useNavigate();var params=useParams();var slug=params.slug;var _useReducer=useReducer(reducer,{product:[],loading:true,error:''}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,error=_useReducer2$.error,product=_useReducer2$.product,dispatch=_useReducer2[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:'FETCH_REQUEST'});_context.prev=1;_context.next=4;return axios.get(\"/api/products/slug/\".concat(slug));case 4:result=_context.sent;dispatch({type:'FETCH_SUCCESS',payload:result.data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:'FETCH_FAIL',payload:getError(_context.t0)});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[slug]);var _useContext=useContext(Store),state=_useContext.state,ctxDispatch=_useContext.dispatch;var cart=state.cart;var addToCartHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var itemExist,quantity,_yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:itemExist=cart.cartItems.find(function(x){return x._id===product._id;});quantity=itemExist?itemExist.quantity+1:1;_context2.next=4;return axios.get(\"/api/products/\".concat(product._id));case 4:_yield$axios$get=_context2.sent;data=_yield$axios$get.data;if(!(data.countInStock<quantity)){_context2.next=9;break;}window.alert('Sorry. Product is out of stock');return _context2.abrupt(\"return\");case 9:ctxDispatch({type:'CART_ADD_ITEM',payload:_objectSpread(_objectSpread({},product),{},{quantity:quantity})});navigate('/cart');case 11:case\"end\":return _context2.stop();}}},_callee2);}));return function addToCartHandler(){return _ref2.apply(this,arguments);};}();return loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsx(\"img\",{className:\"img-large\",src:product.image,alt:product.name})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:product.name})}),/*#__PURE__*/_jsx(\"h1\",{children:product.name})]}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Rating,{rating:product.rating,numReviews:product.numReviews})}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\"Price : $\",product.price]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\"Description:\",/*#__PURE__*/_jsx(\"p\",{children:product.description})]})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Price:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",product.price]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Status:\"}),/*#__PURE__*/_jsx(Col,{children:product.countInStock>0?/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:\"In Stock\"}):/*#__PURE__*/_jsx(Badge,{bg:\"danger\",children:\"Unavailable\"})})]})}),product.countInStock>0&&/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsx(Button,{onClick:addToCartHandler,variant:\"primary\",children:\"Add to Cart\"})})})]})})})})]})});}export default ProductScreen;","map":{"version":3,"names":["axios","useContext","useEffect","useReducer","useNavigate","useParams","Col","Row","ListGroup","Badge","Rating","Button","Helmet","Card","Store","LoadingBox","MessageBox","getError","reducer","state","action","type","loading","product","payload","error","ProductScreen","navigate","params","slug","dispatch","fetchData","get","result","data","ctxDispatch","cart","addToCartHandler","itemExist","cartItems","find","x","_id","quantity","countInStock","window","alert","image","name","rating","numReviews","price","description"],"sources":["C:/Users/dvoge/NJIT-Projects/PP3/scrollshopper/sns/frontend/src/screens/Product.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { useContext, useEffect, useReducer } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport Col from \"react-bootstrap/esm/Col\";\r\nimport Row from \"react-bootstrap/esm/Row\";\r\nimport ListGroup from \"react-bootstrap/esm/ListGroup\";\r\nimport Badge from \"react-bootstrap/esm/Badge\";\r\nimport Rating from \"../components/Rating\";\r\nimport Button from \"react-bootstrap/esm/Button\";\r\nimport { Helmet } from \"react-helmet-async\";\r\nimport Card from 'react-bootstrap/Card';\r\nimport { Store } from \"../Store\";\r\nimport LoadingBox from \"../components/LoadingBox\";\r\nimport MessageBox from \"../components/MessageBox\";\r\nimport { getError } from \"../utils\";\r\n\r\nconst reducer = (state, action) => {\r\n    switch (action.type) {\r\n        case 'FETCH_REQUEST':\r\n            return { ...state, loading: true };\r\n        case 'FETCH_SUCCESS':\r\n            return { ...state, product: action.payload, loading: false };\r\n        case 'FETCH_FAIL':\r\n            return { ...state, loading: false, error: action.payload };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nfunction ProductScreen() {\r\n    const navigate = useNavigate();\r\n    const params = useParams();\r\n    const { slug } = params;\r\n\r\n    const [{ loading, error, product }, dispatch] = useReducer(reducer, {\r\n        product: [],\r\n        loading: true,\r\n        error: '',\r\n    });\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            dispatch({ type: 'FETCH_REQUEST' });\r\n            try {\r\n                const result = await axios.get(`/api/products/slug/${slug}`);\r\n                dispatch({ type: 'FETCH_SUCCESS', payload: result.data });\r\n            } catch (err) {\r\n                dispatch({ type: 'FETCH_FAIL', payload: getError(err) });\r\n            }\r\n        };\r\n        fetchData();\r\n    }, [slug]);\r\n\r\n    const { state, dispatch: ctxDispatch } = useContext(Store);\r\n    const { cart } = state;\r\n    const addToCartHandler = async () => {\r\n        const itemExist = cart.cartItems.find((x) => x._id === product._id);\r\n        const quantity = itemExist ? itemExist.quantity + 1 : 1;\r\n        const { data } = await axios.get(`/api/products/${product._id}`);\r\n        if (data.countInStock < quantity) {\r\n            window.alert('Sorry. Product is out of stock');\r\n            return;\r\n        }\r\n        ctxDispatch({\r\n            type: 'CART_ADD_ITEM',\r\n            payload: { ...product, quantity },\r\n        });\r\n        navigate('/cart');\r\n    };\r\n\r\n    return loading ? (\r\n        <LoadingBox />\r\n    ) : error ? (\r\n        <MessageBox variant=\"danger\">{error}</MessageBox>\r\n    ) : (\r\n        <div>\r\n            <Row>\r\n                <Col md={6}>\r\n                    <img\r\n                        className=\"img-large\"\r\n                        src={product.image}\r\n                        alt={product.name}\r\n                    ></img>\r\n                </Col>\r\n                <Col md={3}>\r\n                    <ListGroup variant=\"flush\">\r\n                        <ListGroup.Item>\r\n                            <Helmet>\r\n                                <title>{product.name}</title>\r\n                            </Helmet>\r\n                            <h1>{product.name}</h1>\r\n                        </ListGroup.Item>\r\n                        <ListGroup.Item>\r\n                            <Rating\r\n                                rating={product.rating}\r\n                                numReviews={product.numReviews}\r\n                            ></Rating>\r\n                        </ListGroup.Item>\r\n                        <ListGroup.Item>Price : ${product.price}</ListGroup.Item>\r\n                        <ListGroup.Item>\r\n                            Description:\r\n                            <p>{product.description}</p>\r\n                        </ListGroup.Item>\r\n                    </ListGroup>\r\n                </Col>\r\n                <Col md={3}>\r\n                    <Card>\r\n                        <Card.Body>\r\n                            <ListGroup variant=\"flush\">\r\n                                <ListGroup.Item>\r\n                                    <Row>\r\n                                        <Col>Price:</Col>\r\n                                        <Col>${product.price}</Col>\r\n                                    </Row>\r\n                                </ListGroup.Item>\r\n                                <ListGroup.Item>\r\n                                    <Row>\r\n                                        <Col>Status:</Col>\r\n                                        <Col>\r\n                                            {product.countInStock > 0 ? (\r\n                                                <Badge bg=\"success\">In Stock</Badge>\r\n                                            ) : (\r\n                                                <Badge bg=\"danger\">Unavailable</Badge>\r\n                                            )}\r\n                                        </Col>\r\n                                    </Row>\r\n                                </ListGroup.Item>\r\n\r\n                                {product.countInStock > 0 && (\r\n                                    <ListGroup.Item>\r\n                                        <div className=\"d-grid\">\r\n                                            <Button onClick={addToCartHandler} variant=\"primary\">Add to Cart</Button>\r\n                                        </div>\r\n                                    </ListGroup.Item>\r\n                                )}\r\n                            </ListGroup>\r\n                        </Card.Body>\r\n                    </Card>\r\n                </Col>\r\n            </Row>\r\n        </div>\r\n    );\r\n}\r\nexport default ProductScreen;"],"mappings":"mlBAAA,MAAOA,MAAP,KAAkB,OAAlB,CACA,OAASC,UAAT,CAAqBC,SAArB,CAAgCC,UAAhC,KAAkD,OAAlD,CACA,OAASC,WAAT,CAAsBC,SAAtB,KAAuC,kBAAvC,CACA,MAAOC,IAAP,KAAgB,yBAAhB,CACA,MAAOC,IAAP,KAAgB,yBAAhB,CACA,MAAOC,UAAP,KAAsB,+BAAtB,CACA,MAAOC,MAAP,KAAkB,2BAAlB,CACA,MAAOC,OAAP,KAAmB,sBAAnB,CACA,MAAOC,OAAP,KAAmB,4BAAnB,CACA,OAASC,MAAT,KAAuB,oBAAvB,CACA,MAAOC,KAAP,KAAiB,sBAAjB,CACA,OAASC,KAAT,KAAsB,UAAtB,CACA,MAAOC,WAAP,KAAuB,0BAAvB,CACA,MAAOC,WAAP,KAAuB,0BAAvB,CACA,OAASC,QAAT,KAAyB,UAAzB,C,wFAEA,GAAMC,QAAO,CAAG,QAAVA,QAAU,CAACC,KAAD,CAAQC,MAAR,CAAmB,CAC/B,OAAQA,MAAM,CAACC,IAAf,EACI,IAAK,eAAL,CACI,sCAAYF,KAAZ,MAAmBG,OAAO,CAAE,IAA5B,GACJ,IAAK,eAAL,CACI,sCAAYH,KAAZ,MAAmBI,OAAO,CAAEH,MAAM,CAACI,OAAnC,CAA4CF,OAAO,CAAE,KAArD,GACJ,IAAK,YAAL,CACI,sCAAYH,KAAZ,MAAmBG,OAAO,CAAE,KAA5B,CAAmCG,KAAK,CAAEL,MAAM,CAACI,OAAjD,GACJ,QACI,MAAOL,MAAP,CARR,CAUH,CAXD,CAaA,QAASO,cAAT,EAAyB,CACrB,GAAMC,SAAQ,CAAGvB,WAAW,EAA5B,CACA,GAAMwB,OAAM,CAAGvB,SAAS,EAAxB,CACA,GAAQwB,KAAR,CAAiBD,MAAjB,CAAQC,IAAR,CAEA,gBAAgD1B,UAAU,CAACe,OAAD,CAAU,CAChEK,OAAO,CAAE,EADuD,CAEhED,OAAO,CAAE,IAFuD,CAGhEG,KAAK,CAAE,EAHyD,CAAV,CAA1D,0EAASH,OAAT,eAASA,OAAT,CAAkBG,KAAlB,eAAkBA,KAAlB,CAAyBF,OAAzB,eAAyBA,OAAzB,CAAoCO,QAApC,iBAKA5B,SAAS,CAAC,UAAM,CACZ,GAAM6B,UAAS,4FAAG,gJACdD,QAAQ,CAAC,CAAET,IAAI,CAAE,eAAR,CAAD,CAAR,CADc,sCAGWrB,MAAK,CAACgC,GAAN,8BAAgCH,IAAhC,EAHX,QAGJI,MAHI,eAIVH,QAAQ,CAAC,CAAET,IAAI,CAAE,eAAR,CAAyBG,OAAO,CAAES,MAAM,CAACC,IAAzC,CAAD,CAAR,CAJU,+EAMVJ,QAAQ,CAAC,CAAET,IAAI,CAAE,YAAR,CAAsBG,OAAO,CAAEP,QAAQ,aAAvC,CAAD,CAAR,CANU,oEAAH,kBAATc,UAAS,0CAAf,CASAA,SAAS,GACZ,CAXQ,CAWN,CAACF,IAAD,CAXM,CAAT,CAaA,gBAAyC5B,UAAU,CAACa,KAAD,CAAnD,CAAQK,KAAR,aAAQA,KAAR,CAAyBgB,WAAzB,aAAeL,QAAf,CACA,GAAQM,KAAR,CAAiBjB,KAAjB,CAAQiB,IAAR,CACA,GAAMC,iBAAgB,6FAAG,uLACfC,SADe,CACHF,IAAI,CAACG,SAAL,CAAeC,IAAf,CAAoB,SAACC,CAAD,QAAOA,EAAC,CAACC,GAAF,GAAUnB,OAAO,CAACmB,GAAzB,EAApB,CADG,CAEfC,QAFe,CAEJL,SAAS,CAAGA,SAAS,CAACK,QAAV,CAAqB,CAAxB,CAA4B,CAFjC,wBAGE3C,MAAK,CAACgC,GAAN,yBAA2BT,OAAO,CAACmB,GAAnC,EAHF,wCAGbR,IAHa,kBAGbA,IAHa,MAIjBA,IAAI,CAACU,YAAL,CAAoBD,QAJH,2BAKjBE,MAAM,CAACC,KAAP,CAAa,gCAAb,EALiB,yCAQrBX,WAAW,CAAC,CACRd,IAAI,CAAE,eADE,CAERG,OAAO,gCAAOD,OAAP,MAAgBoB,QAAQ,CAARA,QAAhB,EAFC,CAAD,CAAX,CAIAhB,QAAQ,CAAC,OAAD,CAAR,CAZqB,yDAAH,kBAAhBU,iBAAgB,2CAAtB,CAeA,MAAOf,QAAO,cACV,KAAC,UAAD,IADU,CAEVG,KAAK,cACL,KAAC,UAAD,EAAY,OAAO,CAAC,QAApB,UAA8BA,KAA9B,EADK,cAGL,kCACI,MAAC,GAAD,yBACI,KAAC,GAAD,EAAK,EAAE,CAAE,CAAT,uBACI,YACI,SAAS,CAAC,WADd,CAEI,GAAG,CAAEF,OAAO,CAACwB,KAFjB,CAGI,GAAG,CAAExB,OAAO,CAACyB,IAHjB,EADJ,EADJ,cAQI,KAAC,GAAD,EAAK,EAAE,CAAE,CAAT,uBACI,MAAC,SAAD,EAAW,OAAO,CAAC,OAAnB,wBACI,MAAC,SAAD,CAAW,IAAX,yBACI,KAAC,MAAD,wBACI,uBAAQzB,OAAO,CAACyB,IAAhB,EADJ,EADJ,cAII,oBAAKzB,OAAO,CAACyB,IAAb,EAJJ,GADJ,cAOI,KAAC,SAAD,CAAW,IAAX,wBACI,KAAC,MAAD,EACI,MAAM,CAAEzB,OAAO,CAAC0B,MADpB,CAEI,UAAU,CAAE1B,OAAO,CAAC2B,UAFxB,EADJ,EAPJ,cAaI,MAAC,SAAD,CAAW,IAAX,wBAA0B3B,OAAO,CAAC4B,KAAlC,GAbJ,cAcI,MAAC,SAAD,CAAW,IAAX,wCAEI,mBAAI5B,OAAO,CAAC6B,WAAZ,EAFJ,GAdJ,GADJ,EARJ,cA6BI,KAAC,GAAD,EAAK,EAAE,CAAE,CAAT,uBACI,KAAC,IAAD,wBACI,KAAC,IAAD,CAAM,IAAN,wBACI,MAAC,SAAD,EAAW,OAAO,CAAC,OAAnB,wBACI,KAAC,SAAD,CAAW,IAAX,wBACI,MAAC,GAAD,yBACI,KAAC,GAAD,qBADJ,cAEI,MAAC,GAAD,gBAAO7B,OAAO,CAAC4B,KAAf,GAFJ,GADJ,EADJ,cAOI,KAAC,SAAD,CAAW,IAAX,wBACI,MAAC,GAAD,yBACI,KAAC,GAAD,sBADJ,cAEI,KAAC,GAAD,WACK5B,OAAO,CAACqB,YAAR,CAAuB,CAAvB,cACG,KAAC,KAAD,EAAO,EAAE,CAAC,SAAV,sBADH,cAGG,KAAC,KAAD,EAAO,EAAE,CAAC,QAAV,yBAJR,EAFJ,GADJ,EAPJ,CAoBKrB,OAAO,CAACqB,YAAR,CAAuB,CAAvB,eACG,KAAC,SAAD,CAAW,IAAX,wBACI,YAAK,SAAS,CAAC,QAAf,uBACI,KAAC,MAAD,EAAQ,OAAO,CAAEP,gBAAjB,CAAmC,OAAO,CAAC,SAA3C,yBADJ,EADJ,EArBR,GADJ,EADJ,EADJ,EA7BJ,GADJ,EALJ,CAwEH,CACD,cAAeX,cAAf"},"metadata":{},"sourceType":"module"}